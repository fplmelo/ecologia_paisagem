<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Felipe Melo">
<meta name="dcterms.date" content="2025-06-08">

<title>Week 6 - Mean Tests and Design of Experiments</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-b8b80a0e6c1bcf998906d62e76552870.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/alpine-3.12/buttons.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../img/ntu_logo.png" alt="NTU logo" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-get-started" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Get Started</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-get-started">    
        <li>
    <a class="dropdown-item" href="../../get-started/1-install.html"><i class="bi bi-emoji-sunglasses-fill" role="img">
</i> 
 <span class="dropdown-text">1 - Install R and Rstudio</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../get-started/2-basic-intro.html"><i class="bi bi-tools" role="img">
</i> 
 <span class="dropdown-text">2 - Basic Introduction to R and Rstudio</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../get-started/3-syntax.html"><i class="bi bi-tools" role="img">
</i> 
 <span class="dropdown-text">3 - Syntax &amp; Data Structures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../get-started/4-functions.html"><i class="bi bi-tools" role="img">
</i> 
 <span class="dropdown-text">4 - Functions and Arguments</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../get-started/5-data.html"><i class="bi bi-tools" role="img">
</i> 
 <span class="dropdown-text">5 - Reading data in R</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../sessions/index.html"> 
<span class="menu-text">Content</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resources/index.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../assessment.html"> 
<span class="menu-text">Assessment</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-ntu-now-page" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">NTU NOW Page</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-ntu-now-page">    
        <li>
    <a class="dropdown-item" href="https://now.ntu.ac.uk/d2l/home/1048957#_"><i class="bi bi-house" role="img">
</i> 
 <span class="dropdown-text">Main NOW Page</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://now.ntu.ac.uk/d2l/lms/dropbox/admin/folders_manage.d2l?ou=1048957"><i class="bi bi-dropbox" role="img">
</i> 
 <span class="dropdown-text">Dropbox</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://twitter.com/quarto_pub" title="Quarto Twitter" class="quarto-navigation-tool px-1" aria-label="Quarto Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/quarto-dev/quarto-cli" title="Quarto GitHub" class="quarto-navigation-tool px-1" aria-label="Quarto GitHub"><i class="bi bi-github"></i></a>
    <a href="https://quarto.org/docs/blog/index.xml" title="Quarto Blog RSS" class="quarto-navigation-tool px-1" aria-label="Quarto Blog RSS"><i class="bi bi-rss"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#preparation" id="toc-preparation" class="nav-link active" data-scroll-target="#preparation">Preparation</a>
  <ul class="collapse">
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives">Learning objectives</a></li>
  </ul></li>
  <li><a href="#lesson" id="toc-lesson" class="nav-link" data-scroll-target="#lesson">Lesson</a></li>
  <li><a href="#part-1---research-methods" id="toc-part-1---research-methods" class="nav-link" data-scroll-target="#part-1---research-methods">Part 1 - Research Methods</a>
  <ul class="collapse">
  <li><a href="#types-of-experimental-desing" id="toc-types-of-experimental-desing" class="nav-link" data-scroll-target="#types-of-experimental-desing">Types of experimental desing</a>
  <ul class="collapse">
  <li><a href="#single-factor-experiments" id="toc-single-factor-experiments" class="nav-link" data-scroll-target="#single-factor-experiments">Single-Factor Experiments</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#part-2---data-analyses" id="toc-part-2---data-analyses" class="nav-link" data-scroll-target="#part-2---data-analyses">Part 2 - Data Analyses</a>
  <ul class="collapse">
  <li><a href="#understanding-mean-tests-in-r" id="toc-understanding-mean-tests-in-r" class="nav-link" data-scroll-target="#understanding-mean-tests-in-r">Understanding Mean Tests in R</a>
  <ul class="collapse">
  <li><a href="#introduction-to-mean-tests" id="toc-introduction-to-mean-tests" class="nav-link" data-scroll-target="#introduction-to-mean-tests">Introduction to Mean Tests</a></li>
  <li><a href="#assumptions-for-mean-tests" id="toc-assumptions-for-mean-tests" class="nav-link" data-scroll-target="#assumptions-for-mean-tests">Assumptions for Mean Tests</a></li>
  <li><a href="#parametric-vs-non-parametric-versions" id="toc-parametric-vs-non-parametric-versions" class="nav-link" data-scroll-target="#parametric-vs-non-parametric-versions">Parametric vs Non-Parametric Versions</a></li>
  <li><a href="#one-sample-comparisons" id="toc-one-sample-comparisons" class="nav-link" data-scroll-target="#one-sample-comparisons">One-sample comparisons</a></li>
  <li><a href="#twoor-more-sample-comparisons-independent-groups" id="toc-twoor-more-sample-comparisons-independent-groups" class="nav-link" data-scroll-target="#twoor-more-sample-comparisons-independent-groups">Two(or more)-sample comparisons (independent groups)</a></li>
  </ul></li>
  <li><a href="#compare-two-groups" id="toc-compare-two-groups" class="nav-link" data-scroll-target="#compare-two-groups">Compare two groups</a></li>
  <li><a href="#compare-more-than-two-groups" id="toc-compare-more-than-two-groups" class="nav-link" data-scroll-target="#compare-more-than-two-groups">Compare more than two groups</a></li>
  <li><a href="#state-the-hypotheses" id="toc-state-the-hypotheses" class="nav-link" data-scroll-target="#state-the-hypotheses">State the Hypotheses</a></li>
  <li><a href="#summary-of-statistical-tests-for-mean-differences" id="toc-summary-of-statistical-tests-for-mean-differences" class="nav-link" data-scroll-target="#summary-of-statistical-tests-for-mean-differences">Summary of Statistical Tests for Mean Differences</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a>
  <ul class="collapse">
  <li><a href="#experimental-desing" id="toc-experimental-desing" class="nav-link" data-scroll-target="#experimental-desing">Experimental Desing</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 6 - Mean Tests and Design of Experiments</h1>
<p class="subtitle lead">RMDA ARES40011</p>
</div>



<div class="quarto-title-meta column-page-left">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Felipe Melo </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 8, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><img src="../../img/mean_test.jpeg" class="img-fluid" width="500"></p>
<p><a href="https://twitter.com/allison_horst" style="text-align: center">Artwork by @allison_horst</a></p>
<section id="preparation" class="level1">
<h1>Preparation</h1>
<section id="learning-objectives" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives">Learning objectives</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Research Methods</th>
<th>Data Analyses</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Types of experimental designs</td>
<td>Understand “mean tests”</td>
</tr>
<tr class="even">
<td>Error Type I and II</td>
<td>Parametric vs.&nbsp;non-parametric mean tests</td>
</tr>
<tr class="odd">
<td></td>
<td>Data visualization for means</td>
</tr>
</tbody>
</table>
<p><strong>For Data Analyses</strong></p>
<ul>
<li><i class="fa-solid fa-book" aria-label="book"></i> <a href="https://brad-cannell.github.io/r_notes/contingency-tables.html">Check chapter this e-book, R Notes</a></li>
<li><i class="fa-solid fa-book" aria-label="book"></i> <a href="http://www.cookbook-r.com/Manipulating_data/Converting_between_data_frames_and_contingency_tables/">Cookbook for R</a></li>
<li><i class="fa-solid fa-tools" aria-label="tools"></i> <a href="https://sbc.shef.ac.uk/stats-in-r/practical.nb.html">Nice Tutorial for Contignecy Tables</a></li>
<li><i class="fa-solid fa-tools" aria-label="tools"></i> <a href="https://www.sthda.com/english/wiki/chi-square-test-of-independence-in-r">Nice Tutorial for Chi-Square tests</a></li>
</ul>
<p><strong>For Research Methods</strong></p>
<ul>
<li><p><i class="fa-solid fa-book" aria-label="book"></i> <a href="https://en.wikipedia.org/wiki/Replication_(statistics)">What is replication?</a></p></li>
<li><p><i class="fa-solid fa-video" aria-label="video"></i> <a href="https://youtu.be/oFz8iOx96mw">Degrees of Freeedom</a></p></li>
<li><p><i class="fa-solid fa-video" aria-label="video"></i> <a href="https://youtu.be/sk5ttlX2i5I">About statistical power and replicates in experimental design</a></p></li>
<li><p><i class="fa-solid fa-video" aria-label="video"></i> <a href="https://youtu.be/Mufk0ZJVqQY">Understanding Replication and Randomization</a></p></li>
<li><p><i class="fa-solid fa-video" aria-label="video"></i> <a href="https://youtu.be/DavsDxgYQo4">Types of experiments</a></p></li>
</ul>
</section>
</section>
<section id="lesson" class="level1">
<h1>Lesson</h1>
</section>
<section id="part-1---research-methods" class="level1">
<h1>Part 1 - Research Methods</h1>
<section id="types-of-experimental-desing" class="level2">
<h2 class="anchored" data-anchor-id="types-of-experimental-desing">Types of experimental desing</h2>
<p>Experimental design is a crucial process for ensuring that studies are statistically sound and that conclusions drawn from them are reliable. It involves carefully planning how data will be collected to answer a specific question. Experimental designs are broadly classified into two main categories:</p>
<p><strong>Single-Factor Experiments</strong> and <strong>Multi-Factor Experiments</strong>.</p>
<section id="single-factor-experiments" class="level3">
<h3 class="anchored" data-anchor-id="single-factor-experiments">Single-Factor Experiments</h3>
<p>These experiments involve varying only a single factor or treatment, while all other factors are kept constant or applied uniformly to all plots.</p>
<p><strong>1. Completely Randomized Design (CRD)</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img/crd.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="300"></p>
</figure>
</div>
<p>In a CRD, treatments are assigned completely at random to experimental units, ensuring each unit has an equal chance of receiving any one treatment.</p>
<p>Homogeneity Requirement: CRD is applicable primarily when the experimental material is homogenous. It is generally used in lab experimental conditions where environmental factors can be easily controlled. Due to the typical heterogeneity of soil in fields, CRD is often not the preferred method for field experiments.</p>
<p>Local Control: The principle of ‘Local-control’ is not used in CRD.</p>
<p>Advantages: CRD is easy to understand, allows for a varying number of replications per treatment, offers high flexibility in the number of treatments used, requires simple statistical analysis, and provides the maximum number of degrees of freedom.</p>
<p>Disadvantages: It can only be applied to homogenous experiments and does not incorporate the principle of ‘Local-control’.</p>
<p><strong>2. Randomized Block Design (RBD)</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img/rbd.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="300"></p>
</figure>
</div>
<p>RBD is the most commonly used experimental design in agriculture. It incorporates ‘local-control’ by grouping experimental material into homogenous subgroups called blocks. Each block then contains the entire set of treatments, making a block equivalent to a replication.</p>
<p>Key Principles: RBD effectively utilizes all three core principles of experimental design: replication, randomization, and local-control.</p>
<p>Replication: In RBD, blocks are repeated across the field, often four to six times, to gather more data from a broader area and increase confidence in the results, such as yield differences.</p>
<p>Randomization: To eliminate bias and avoid unintended benefits from field variability (e.g., a field becoming more productive from east to west), the placement of each treatment within a block is assigned by chance, such as by flipping a coin. This ensures that any observed yield differences are genuinely due to the treatments and not other uncontrolled factors.</p>
<p>Advantages: RBD is generally more efficient and accurate than CRD, has a lower chance of error, offers high flexibility in the number of treatments and replications, and allows for relatively simple statistical analysis, even if a single value is missing. Errors related to any treatment can be isolated.</p>
<p>Disadvantages: RBD is not recommended for a very large number of treatments because this can increase the size of each block, potentially leading to heterogeneity within blocks and higher experimental errors.</p>
<p><strong>Other Noteworthy Experimental Designs</strong></p>
<p>• Randomized Two-Treatment Experiment: Involves randomly assigning individuals to one of two groups, typically an experimental condition (where the hypothesized cause is present) and a control condition (where it’s absent or a placebo is given). Random assignment aims to ensure groups are similar in all respects, including pre-existing conditions.</p>
<p>•Rigorously Controlled Design: This design involves carefully assigning subjects to treatment groups to ensure they are similar in important ways. However, it is hard to implement due to the difficulty in identifying all relevant differentiations and should generally be avoided.</p>
<p>• Matched Pairs Design: Treatments are administered to two groups that are matched in certain ways. Examples include measuring the same individual’s right arm versus left arm, or conducting before-and-after experiments (e.g., weight before and after a diet).</p>
<p>• Repeated Measures Design: In this design, all participants are exposed to all levels of the independent variable, meaning they experience all conditions. Random assignment occurs for the order in which these conditions are experienced, rather than assigning participants to specific conditions.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../img/plant_exp.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="300"></p>
</figure>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>All true experiments, regardless of their specific type, emphasize random assignment to conditions, which is crucial for maximizing internal validity. Replication, the repetition of an experiment on more than one subject, is also vital to ensure the sample is large enough to differentiate true effects from random ones and to allow others to duplicate results.</p>
</div>
</div>
</section>
</section>
</section>
<section id="part-2---data-analyses" class="level1">
<h1>Part 2 - Data Analyses</h1>
<section id="understanding-mean-tests-in-r" class="level2">
<h2 class="anchored" data-anchor-id="understanding-mean-tests-in-r">Understanding Mean Tests in R</h2>
<p>Mean tests are statistical procedures used to determine if there are significant differences between the means of two or more groups, or if a sample mean is significantly different from a specific value. These tests are fundamental in validating relationships, especially when dealing with a categorical variable and a continuous variable. The sources highlight various tests, including t-tests, Analysis of Variance (ANOVA), and their non-parametric counterparts, the Wilcoxon rank sum test and Kruskal-Wallis test</p>
<section id="introduction-to-mean-tests" class="level3">
<h3 class="anchored" data-anchor-id="introduction-to-mean-tests">Introduction to Mean Tests</h3>
<p>Mean tests are fundamental statistical tools used to <strong>determine if there are significant differences between the average values (means) of one or more groups or against a specific hypothesised value</strong>. They are crucial for drawing conclusions from data in various fields, including epidemiology and data science.</p>
</section>
<section id="assumptions-for-mean-tests" class="level3">
<h3 class="anchored" data-anchor-id="assumptions-for-mean-tests">Assumptions for Mean Tests</h3>
<p>Parametric mean tests, such as the t-test and ANOVA, rely on several key assumptions about the data [5-12]. It is a best practice to <strong>visually check data distribution and run assumption tests prior to performing any statistical tests</strong>.</p>
<p>The common assumptions for parametric tests are:</p>
<ul>
<li><p><strong>Independence</strong>: The samples are independent of each other [5, 6, 10]. For example, in an unpaired t-test, the observations in one group should not be related to the observations in another group. Paired tests, however, are an exception, as they explicitly deal with related or dependent samples.</p></li>
<li><p><strong>Normality</strong>: The data for each group or the differences between paired observations should be <strong>approximately normally distributed</strong>.</p>
<ul>
<li><p><strong>Checking normality</strong>: This can be assessed using the <strong>Shapiro-Wilk test</strong> (<code>shapiro.test()</code> from <code>base</code> R or <code>shapiro_test()</code> from <code>rstatix</code>), which is suitable for sample sizes between 3 and 5000 observations. A p-value greater than 0.05 from this test indicates that the data distribution is not significantly different from a normal distribution, suggesting normality can be assumed.</p></li>
<li><p><strong>Visual confirmation</strong>: <strong>Quantile-Quantile (Q-Q) plots</strong> (<code>ggqqplot()</code> from <code>ggpubr</code>) or <strong>histograms</strong> (<code>geom_histogram()</code> with <code>ggplot</code>) are useful visual tools to assess normality [19-23]. If points in a Q-Q plot fall approximately along the reference line, normality can be assumed [19]. Statistical tests can sometimes be overly sensitive to large sample sizes or not sensitive enough at low sample sizes, making visual interpretation valuable.</p></li>
<li><p><strong>Large Sample Sizes</strong>: For sample sizes greater than 30 (n &gt; 30), the <strong>Central Limit Theorem</strong> suggests that violations of the normality assumption should not pose major issues, allowing the use of parametric tests [25]. However, visual checks and the Shapiro-Wilk test can still help identify serious deviations.</p></li>
</ul></li>
<li><p><strong>Homoscedasticity (Equality of Variances)</strong>: The variance of the outcome variable should be <strong>equal across the groups</strong> being compared. This assumption is primarily made by the <strong>classic Student’s t-test</strong> and standard ANOVA.</p>
<ul>
<li><strong>Checking homoscedasticity</strong>: <strong>Levene’s test</strong> (<code>leveneTest()</code> from <code>car</code> package or <code>levene_test()</code> from <code>rstatix</code>) is a robust method to compare variances. A p-value greater than 0.05 suggests that the variances are not significantly different, implying homogeneity of variances.</li>
<li><strong>Visual confirmation</strong>: Boxplots can also be used to visually examine homoscedasticity.</li>
<li><strong>Handling unequal variances</strong>: If variances are unequal, <strong>Welch’s t-test</strong> (for two groups) or <strong>Welch’s ANOVA</strong> (for more than two groups) are more appropriate alternatives as they do not assume equal variances. R’s <code>t.test()</code> function defaults to Welch’s t-test, making it a safer choice.</li>
</ul></li>
<li><p><strong>No Significant Outliers</strong>: <strong>Outliers</strong> can skew results and violate assumptions. They can be identified using boxplot methods, such as <code>identify_outliers()</code> from the <code>rstatix</code> package. If extreme outliers are present, non-parametric tests might be considered.</p></li>
</ul>
</section>
<section id="parametric-vs-non-parametric-versions" class="level3">
<h3 class="anchored" data-anchor-id="parametric-vs-non-parametric-versions">Parametric vs Non-Parametric Versions</h3>
<p>The choice between parametric and non-parametric tests largely depends on whether the data meets the assumptions of parametric tests, especially normality and homoscedasticity.</p>
<ul>
<li><strong>Parametric Tests</strong>:
<ul>
<li>Assume specific distributions for the data (e.g., normal distribution) and often require assumptions about the equality of variances.</li>
<li>Examples include <strong>T-tests</strong> and <strong>Analysis of Variance (ANOVA)</strong>.</li>
<li>They are generally more powerful when their assumptions are met.</li>
</ul></li>
<li><strong>Non-Parametric Tests</strong>:
<ul>
<li>Do <strong>not rely on assumptions about the distribution of the data</strong>.</li>
<li>Often focus on medians or ranks rather than means.</li>
<li>Examples include the <strong>Wilcoxon test</strong> (Rank-Sum test for two groups, Signed-Rank test for paired samples) and the <strong>Kruskal-Wallis test</strong> (for more than two groups).</li>
<li>Recommended when parametric test assumptions are violated.</li>
</ul></li>
</ul>
</section>
<section id="one-sample-comparisons" class="level3">
<h3 class="anchored" data-anchor-id="one-sample-comparisons">One-sample comparisons</h3>
<p>One-sample t-test is used to compare the mean of one sample to a known standard (or theoretical/hypothetical) mean (μ).</p>
<p>Generally, the theoretical mean comes from:</p>
<ul>
<li><p>A previous experiment. For example, compare whether the mean weight of mice differs from 200 mg, a value determined in a previous study.</p></li>
<li><p>From an experiment where you have control and treatment conditions. If you express your data as “percent of control”, you can test whether the average value of treatment condition differs significantly from 100.</p></li>
</ul>
<p>In statistics, we can define the corresponding null hypothesis (H0) as follow:</p>
<p><span class="math inline">\(H_0 : m=\mu\)</span></p>
<p><span class="math inline">\(H_0 : m \geq \mu\)</span></p>
<p><span class="math inline">\(H_0 : m \leq \mu\)</span></p>
<p>The corresponding alternative hypotheses (H’) are as follow:</p>
<p><span class="math inline">\(H': m\neq\mu\)</span> (just different)</p>
<p><span class="math inline">\(H' : m &lt; \mu\)</span> (smaller)</p>
<p><span class="math inline">\(H' : m &gt; \mu\)</span> (greater)</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Now, imagine the <code>palmerpenguins</code> dataset. Imagine that you are a researcher working with penguins and someone reported a carcase of a dead penguin in an island that where you know that species <code>Adelie</code> was never registered. The only precise data you have is the length of the bill found (39.2mm). Can we use a <strong>one-sample test</strong> for that?</p>
</div>
</div>
<p>Let’s check the mean values of bill length</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span> </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">bill_length_mean =</span> <span class="fu">mean</span>(bill_length_mm), <span class="at">bill_lengh_sd =</span> <span class="fu">sd</span>(bill_length_mm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  species   bill_length_mean bill_lengh_sd
  &lt;fct&gt;                &lt;dbl&gt;         &lt;dbl&gt;
1 Adelie                38.8          2.66
2 Chinstrap             48.8          3.34
3 Gentoo                47.6          3.11</code></pre>
</div>
</div>
<p>Let’s test our possible hypotheses</p>
<p>1- The dead penguin is from <strong>Adelie</strong> species, then <span class="math inline">\(H' : m &lt; \mu\)</span> where <span class="math inline">\(\mu\)</span> is the carcase and <code>m</code> could be the mean of other penguin species, let’s say <strong>Chinstrap</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species<span class="sc">==</span><span class="st">"Adelie"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(bill_length_mm) <span class="ot">-&gt;</span> m</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(m, <span class="at">mu =</span> <span class="fl">39.2</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  m
t = -1.8852, df = 150, p-value = 0.06134
alternative hypothesis: true mean is not equal to 39.2
95 percent confidence interval:
 38.36312 39.21966
sample estimates:
mean of x 
 38.79139 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(m, <span class="at">mu =</span> <span class="fl">39.2</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  m
t = -1.8852, df = 150, p-value = 0.9693
alternative hypothesis: true mean is greater than 39.2
95 percent confidence interval:
 38.43266      Inf
sample estimates:
mean of x 
 38.79139 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(m, <span class="at">mu =</span> <span class="fl">39.2</span>, <span class="at">alternative =</span> <span class="st">"less"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  m
t = -1.8852, df = 150, p-value = 0.03067
alternative hypothesis: true mean is less than 39.2
95 percent confidence interval:
     -Inf 39.15012
sample estimates:
mean of x 
 38.79139 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species<span class="sc">==</span><span class="st">"Chinstrap"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(bill_length_mm) <span class="ot">-&gt;</span> m</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(m, <span class="at">mu =</span> <span class="fl">39.2</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  m
t = 23.79, df = 67, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 39.2
95 percent confidence interval:
 48.02555 49.64210
sample estimates:
mean of x 
 48.83382 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(m, <span class="at">mu =</span> <span class="fl">39.2</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  m
t = 23.79, df = 67, p-value &lt; 2.2e-16
alternative hypothesis: true mean is greater than 39.2
95 percent confidence interval:
 48.15841      Inf
sample estimates:
mean of x 
 48.83382 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(m, <span class="at">mu =</span> <span class="fl">39.2</span>, <span class="at">alternative =</span> <span class="st">"less"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  m
t = 23.79, df = 67, p-value = 1
alternative hypothesis: true mean is less than 39.2
95 percent confidence interval:
     -Inf 49.50924
sample estimates:
mean of x 
 48.83382 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species<span class="sc">==</span><span class="st">"Gentoo"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(bill_length_mm) <span class="ot">-&gt;</span> m</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(m, <span class="at">mu =</span> <span class="fl">39.2</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  m
t = 29.886, df = 122, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 39.2
95 percent confidence interval:
 46.95478 48.05497
sample estimates:
mean of x 
 47.50488 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(m, <span class="at">mu =</span> <span class="fl">39.2</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  m
t = 29.886, df = 122, p-value &lt; 2.2e-16
alternative hypothesis: true mean is greater than 39.2
95 percent confidence interval:
 47.04431      Inf
sample estimates:
mean of x 
 47.50488 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(m, <span class="at">mu =</span> <span class="fl">39.2</span>, <span class="at">alternative =</span> <span class="st">"less"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  m
t = 29.886, df = 122, p-value = 1
alternative hypothesis: true mean is less than 39.2
95 percent confidence interval:
     -Inf 47.96545
sample estimates:
mean of x 
 47.50488 </code></pre>
</div>
</div>
<p>From all comparison, the one that rejected more differences was the first (compared to Adelie), so our scientific hypotheses that the carcase might belongs to an Adelie penguins cannot be rejected. All other comparisons, rejected this scientific hypothesis.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Exactly the same logic applies to the non-parametric version of the test: <strong>Wilcoxon test</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species<span class="sc">==</span><span class="st">"Adelie"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(bill_length_mm)<span class="ot">-&gt;</span> m <span class="co"># Note that I had to use the fucntion pull to extract a numeric vector rather than a tibble acecpted by t.test before</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(m, <span class="at">mu =</span> <span class="fl">39.2</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  m
V = 4447, p-value = 0.04137
alternative hypothesis: true location is not equal to 39.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(m, <span class="at">mu =</span> <span class="fl">39.2</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  m
V = 4447, p-value = 0.9794
alternative hypothesis: true location is greater than 39.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(m, <span class="at">mu =</span> <span class="fl">39.2</span>, <span class="at">alternative =</span> <span class="st">"less"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test with continuity correction

data:  m
V = 4447, p-value = 0.02069
alternative hypothesis: true location is less than 39.2</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="twoor-more-sample-comparisons-independent-groups" class="level3">
<h3 class="anchored" data-anchor-id="twoor-more-sample-comparisons-independent-groups">Two(or more)-sample comparisons (independent groups)</h3>
<p>This test is used to compare the means of two independent groups. For instance, it can compare the average weights of individuals grouped by gender. There are two primary forms:</p>
<p>• <strong>Student’s t-test</strong>: Assumes that the variance of the two groups are equal.</p>
<p>• <strong>Welch’s t-test</strong>: Is less restrictive and does not assume equal variances between the two groups. By default, R typically computes the Welch’s t-test, which is considered the safer option, especially when group sizes and standard deviations are very different. * <strong>Analyses of Variance</strong>: Works similarly as the t-test but is able to compare more than two groups and uses a different calculation to decide on whether or not to reject null hypothesis, via <strong>F-statisticis</strong></p>
<p><strong>Assumptions</strong>:</p>
<ul>
<li><p>Independence of observations: Each subject should belong to only one group, and there should be no relationship between observations across groups.</p></li>
<li><p>No significant outliers in either group.</p></li>
<li><p>Normality: The data for each group should be approximately normally distributed.</p></li>
<li><p>Homogeneity of variances: The variance of the outcome variable should be equal in each group. This assumption is specifically for the standard Student’s t-test and is relaxed in the Welch’s t-test. Homogeneity of variances can be checked using Levene’s test. If variances are unequal, Welch’s t-test is often preferred as it maintains a more accurate Type I error rate</p></li>
</ul>
<p><strong>Non-Parametric Alternatives</strong></p>
<p>When the assumptions for parametric tests (like t-tests or ANOVA) are not met, particularly normality or homogeneity of variances, non-parametric alternatives are recommended.</p>
<p>• <strong>Wilcoxon Rank Sum Test (Mann-Whitney U test)</strong>: This is the non-parametric alternative to the independent samples t-test. It determines if two numeric samples are from the same distribution when populations are not normally distributed or have unequal variance, focusing on comparing medians rather than means.</p>
<p>• <strong>Kruskal-Wallis Test</strong>: This is the non-parametric alternative to one-way ANOVA. It tests for differences in the distribution of more than two samples when normality cannot be assumed. Like ANOVA, it is an “omnibus” test and typically requires pairwise Wilcoxon tests as post-hoc analyses to identify specific group differences.</p>
</section>
</section>
<section id="compare-two-groups" class="level2">
<h2 class="anchored" data-anchor-id="compare-two-groups">Compare two groups</h2>
<p>Let’s consider again the Penguins dataset. Can I use the bill length as helpful character to separate species?</p>
<p>Let’s see if Chinstrap and Gentoo species differ in bill length</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Method 1</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species<span class="sc">==</span><span class="st">"Chinstrap"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(bill_length_mm)<span class="ot">-&gt;</span>x</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species<span class="sc">==</span><span class="st">"Gentoo"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(bill_length_mm)<span class="ot">-&gt;</span>y</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(x, y, <span class="at">var.equal =</span> <span class="cn">TRUE</span>, <span class="at">alternative=</span><span class="st">"two.sided"</span>) <span class="co"># testing if they are different</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  x and y
t = 2.7694, df = 189, p-value = 0.006176
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.3823625 2.2755285
sample estimates:
mean of x mean of y 
 48.83382  47.50488 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(x, y, <span class="at">alternative=</span><span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  x and y
t = 2.706, df = 129.22, p-value = 0.003865
alternative hypothesis: true difference in means is greater than 0
95 percent confidence interval:
 0.515293      Inf
sample estimates:
mean of x mean of y 
 48.83382  47.50488 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(x, y, <span class="at">alternative=</span><span class="st">"less"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  x and y
t = 2.706, df = 129.22, p-value = 0.9961
alternative hypothesis: true difference in means is less than 0
95 percent confidence interval:
     -Inf 2.142598
sample estimates:
mean of x mean of y 
 48.83382  47.50488 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Method 2</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(species<span class="sc">!=</span><span class="st">"Adelie"</span>)<span class="ot">-&gt;</span>peng.t.test </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t.test</span>(bill_length_mm<span class="sc">~</span>species, <span class="at">var.equal=</span><span class="cn">TRUE</span>, <span class="at">data =</span> peng.t.test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  bill_length_mm by species
t = 2.7694, df = 189, p-value = 0.006176
alternative hypothesis: true difference in means between group Chinstrap and group Gentoo is not equal to 0
95 percent confidence interval:
 0.3823625 2.2755285
sample estimates:
mean in group Chinstrap    mean in group Gentoo 
               48.83382                47.50488 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>   <span class="fu">t.test</span>(bill_length_mm<span class="sc">~</span>species, <span class="at">var.equal=</span><span class="cn">FALSE</span>, <span class="at">data =</span> peng.t.test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  bill_length_mm by species
t = 2.706, df = 129.22, p-value = 0.00773
alternative hypothesis: true difference in means between group Chinstrap and group Gentoo is not equal to 0
95 percent confidence interval:
 0.3572698 2.3006212
sample estimates:
mean in group Chinstrap    mean in group Gentoo 
               48.83382                47.50488 </code></pre>
</div>
</div>
</section>
<section id="compare-more-than-two-groups" class="level2">
<h2 class="anchored" data-anchor-id="compare-more-than-two-groups">Compare more than two groups</h2>
<p><strong>ANOVA</strong> is used when you want to compare the means of three or more independent groups on a particular continuous variable. It tells you whether there’s an overall statistically significant difference among the group means.</p>
<p>Let’s try to determine if there is a statistically significant difference in the mean <code>bill length</code> (bill_length_mm) among the different penguin species.</p>
<ul>
<li><p>Categorical Independent Variable (Factor): species (Adelie, Chinstrap, Gentoo) - 3 levels/groups</p></li>
<li><p>Continuous Dependent Variable: bill_length_mm</p></li>
</ul>
</section>
<section id="state-the-hypotheses" class="level2">
<h2 class="anchored" data-anchor-id="state-the-hypotheses">State the Hypotheses</h2>
<ul>
<li>Null Hypothesis (H0): The mean bill length is the same across all penguin species (μ_Adelie = μ_Chinstrap = μ_Gentoo)</li>
<li>Alternative Hypothesis (Ha): At least one penguin species has a different mean bill length from the others. (Not all means are equal)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(bill_length_mm <span class="sc">~</span> species, <span class="at">data =</span> penguins)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)    
species       2   7194    3597   410.6 &lt;2e-16 ***
Residuals   339   2970       9                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
2 observations deleted due to missingness</code></pre>
</div>
</div>
<p><strong>Visualise the data</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(species, bill_length_mm, <span class="at">color=</span>species, <span class="at">fill=</span>species))<span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>() <span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="week6_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can see visually that Adelie penguins have shorter bills, but how do we get a statistic confirmation on who differs from whom?</p>
<p><strong>Post-hoc pairwise comparisons</strong></p>
<p>In this case, let’s apply one of the most common tests, the <code>Tukey Test</code> for pairwise comparisons.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = bill_length_mm ~ species, data = penguins)

$species
                      diff       lwr        upr     p adj
Chinstrap-Adelie 10.042433  9.024859 11.0600064 0.0000000
Gentoo-Adelie     8.713487  7.867194  9.5597807 0.0000000
Gentoo-Chinstrap -1.328945 -2.381868 -0.2760231 0.0088993</code></pre>
</div>
</div>
<p>Easy to see now, that actually, all species differ in their bill length and there were hidden differences that a simple visual inspection is not able to grasp.</p>
</section>
<section id="summary-of-statistical-tests-for-mean-differences" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-statistical-tests-for-mean-differences">Summary of Statistical Tests for Mean Differences</h2>
<div id="tbl-statistical-tests" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-statistical-tests-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: <strong>Table 1: Summary of Comparisons of Statistical Tests for Analysing Mean Differences</strong>
</figcaption>
<div aria-describedby="tbl-statistical-tests-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 4%">
<col style="width: 23%">
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Feature</th>
<th style="text-align: left;">T-test (Parametric)</th>
<th style="text-align: left;">ANOVA (Parametric)</th>
<th style="text-align: left;">Wilcoxon Test (Non-parametric)</th>
<th style="text-align: left;">Kruskal-Wallis Test (Non-parametric)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Number of Groups</strong></td>
<td style="text-align: left;"><strong>Two groups</strong>, or <strong>one sample vs.&nbsp;a known value</strong>.</td>
<td style="text-align: left;"><strong>Three or more groups</strong>.</td>
<td style="text-align: left;"><strong>Two groups</strong>, or <strong>one sample vs.&nbsp;a known value</strong>.</td>
<td style="text-align: left;"><strong>Three or more groups</strong>. When only two samples are used, results are identical to Wilcoxon rank sum test.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Dependent/Independent</strong></td>
<td style="text-align: left;">Both <strong>independent</strong> and <strong>paired</strong> variants exist.</td>
<td style="text-align: left;">Typically <strong>independent groups</strong>.</td>
<td style="text-align: left;">Both <strong>independent</strong> (rank sum) and <strong>paired</strong> (signed-rank) variants exist.</td>
<td style="text-align: left;"><strong>Independent groups</strong>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Key Assumption</strong></td>
<td style="text-align: left;"><strong>Normality of data</strong> (or differences for paired) and <strong>homogeneity of variance</strong> (for Student’s). No significant outliers. Independence of observations for independent samples.</td>
<td style="text-align: left;"><strong>Normality of data</strong> and <strong>homogeneity of variance</strong>. Data independence.</td>
<td style="text-align: left;"><strong>No specific distribution assumption</strong> (non-parametric).</td>
<td style="text-align: left;"><strong>No specific distribution assumption</strong> (non-parametric).</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>What it Compares</strong></td>
<td style="text-align: left;"><strong>Means</strong>.</td>
<td style="text-align: left;"><strong>Means</strong>.</td>
<td style="text-align: left;"><strong>Medians or distributions</strong>.</td>
<td style="text-align: left;"><strong>Medians or distributions</strong>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>R Functions (Base)</strong></td>
<td style="text-align: left;"><code>t.test()</code>.</td>
<td style="text-align: left;"><code>aov()</code>.</td>
<td style="text-align: left;"><code>wilcox.test()</code>.</td>
<td style="text-align: left;"><code>kruskal.test()</code>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>R Packages (Others)</strong></td>
<td style="text-align: left;"><code>rstatix::t_test()</code>, <code>gtsummary::add_p()</code>, <code>report::report()</code>.</td>
<td style="text-align: left;"><code>gtsummary::add_p()</code>, <code>report::report()</code>.</td>
<td style="text-align: left;"><code>rstatix::wilcox_test()</code>, <code>gtsummary::add_p()</code>.</td>
<td style="text-align: left;"><code>rstatix::kruskal_test()</code>, <code>gtsummary::add_p()</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Post-hoc Test Needed?</strong></td>
<td style="text-align: left;">No (compares only two groups).</td>
<td style="text-align: left;">Yes, if omnibus test is significant (<code>pairwise.t.test()</code> or <code>TukeyHSD()</code>).</td>
<td style="text-align: left;">No (compares only two groups).</td>
<td style="text-align: left;">Yes, if significant (<code>pairwise.wilcox.test()</code>).</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Robustness</strong></td>
<td style="text-align: left;"><strong>Welch’s is robust to unequal variances</strong>. Generally robust to normality violations.</td>
<td style="text-align: left;">Less robust to unequal variances with unbalanced sample sizes.</td>
<td style="text-align: left;">Generally <strong>more robust to assumption violations</strong>.</td>
<td style="text-align: left;">Generally <strong>more robust to assumption violations</strong>. Can be unstable with heteroscedasticity.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Relationship</strong></td>
<td style="text-align: left;">Special case of ANOVA when comparing two groups with equal variances. Subsumed under the General Linear Model.</td>
<td style="text-align: left;">Generalisation of the t-test; related to linear regression. Subsumed under the General Linear Model.</td>
<td style="text-align: left;">Non-parametric alternative to t-test.</td>
<td style="text-align: left;">Non-parametric alternative to one-way ANOVA; extension of Wilcoxon.</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section>
<section id="exercises" class="level2">
<h2 class="anchored" data-anchor-id="exercises">Exercises</h2>
<section id="experimental-desing" class="level3">
<h3 class="anchored" data-anchor-id="experimental-desing">Experimental Desing</h3>
<p>1-</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Content <i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i> 2025 by <a href="https://ecoaplic.org/">felipe Melo</a> <br> All content licensed under a <i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i> <i class="fa-brands fa-creative-commons-by" aria-label="creative-commons-by"></i> <i class="fa-brands fa-creative-commons-nc" aria-label="creative-commons-nc"></i> <a href="https://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International license (CC BY-NC 4.0)</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Made with <i class="fa-brands fa-r-project" aria-label="r-project"></i> and <a href="https://quarto.org/">Quarto</a><br> <a href="https://github.com/fplmelo/rmda_ntu">View the source at <i class="fa-brands fa-github" aria-label="github"></i> GitHub</a></p>
</div>
  </div>
</footer>




<script src="../../site_libs/quarto-contrib/alpine-3.12/alpine@3.12.min.js"></script>
</body></html>